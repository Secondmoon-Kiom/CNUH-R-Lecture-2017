---
title: \textbf{\LARGE R을 이용한 자료처리 및 시각화}
subtitle: \textbf{\Large 기본 환경 설정부터 재현가능한 연구 방법 입문}\vspace{2cm}\linebreak 한국한의학연구원 한의기반연구부\linebreak Korea Institute of Oriental Medicine, KM Fundamental Research Division \vspace{2cm} 
author: \textbf{\Large 구본초, Ph.D. in Statistics}
date: "2017-11-23"
output: 
  bookdown::pdf_book:
    includes: 
      in_header: preamble.tex
    toc: true 
    toc_depth: 2
    highlight: tango
    fig_caption: yes
    citation_package: natbib
    keep_tex: yes
documentclass: book
classoption: a4paper
link-citation: yes
colorlinkgs: yes
lot: no
lof: no
fontsize: 12pt
urlcolor: blue
bibliography: CNUH.bib

---


```{r knitr_init, echo=FALSE, results="hide", message=FALSE, cache=FALSE}
 
knitr::opts_knit$set(root.dir = '..') 
options(max.print = 5000)
knitr::opts_chunk$set(eval = TRUE, echo = FALSE, cache = FALSE, include = TRUE, collapse = FALSE, tidy=TRUE, message=FALSE, warning=FALSE,
                      dependson = NULL, engine = "R", error = TRUE, fig.path="Figures/", fig.align = "center", fig.width = 7, fig.height = 7,
                     fig.keep='all', fig.retina=2, background = '#F7F7F7', highlight = T, comment = NA, tidy = TRUE, tidy.opts=list(blank=FALSE, width.cutoff=50))
```

# R을 사용하기 위한 환경 설정

## Overview

### What is R?

- R 언어: 통계 및 자료 시각화를 지원하는 언어 및 환경

- 1980년 AT\&T 연구소의 John Chambers가 개발한 S 언어를 기반으로 1995년 뉴질랜드 Auckland Univ.의 Robert Gentleman \& Ross Ihaka 개발이 그 기원임

- GNU 기반 오픈소스

### Why R? 

1. 장점
    - \textbf{Free software}
    - 주요 운영체제(Unix, Windows, Macintosh)에서 사용 가능
    - 현존하는 거의 대부분의 통계 방법론들이 package로 구현
    - 강력한 그래픽 기능
    - 빠른 update 및 연산속도(?)
    - 방대한 community 및 R package에 공개 및 공유된 자료

2. Do we have to learn R language?
    - 물론 꼭 배울 필요는 없다!! (요리를 하는데 꼭 좋은 칼이 필요 없듯이...)
    - 다양한 통계 소프트웨어 및 분석 언어(SPSS, SAS, WEKA, MATLAB, PYTHON, ...) 존재
    - 프로그래밍에 익숙하지 않은 사용자들의 접근성이 떨어짐
    - 하지만 배워두면 좋은 이유
        - 통계분석과 보고서 작성을 위한 최적 환경
            - R + Rstudio + Rmarkdown을 통해 분석에서부터 보고서 작성까지 한번에 가능 
        - SPSS, SAS에 비해 확장성이 높기 때문에 다양한 문제에 적용 가능
        - 방대한 양의 메뉴얼 및 서적들
        - 그리고 이 모든 것을 거의 대부분 무료 사용 가능
      
\begin{quote}
\colorbox{gray!10}{\begin{minipage}{15cm}
\textbf{Tips}
  \begin{itemize}
    \item R에서 구현한 모든 package들은 CRAN (The Comprehensive R Archive Network, http://cran.r-project.org/web/view)에서 살펴볼 수 있음
    \item R과 관련한 대부분의 문제는 Google 검색과 스텍 오버플로우(http://stackoverflow.com)에서 해결할 수 있음
    \item 해당 문서는 서민구 선생님의 ``R을 이용한 데이터 처리 \& 실무'' \citep{Seo-2014}, 고석범 선생님의 ``R과 Knitr을 활용한 데이터 연동형 문서 만들기'' \citep{Ko-2014}, R Friend 님의 블로그 ``R, Phython 분석과 프로그래밍'' \citep{RFriend} 의 내용을 주로 참조함. 
    \item 해당 문서는 \texttt{RMarkdown} + \latex + \texttt{knitr}로 작성된 문서이며, 이를 위해 작성한 모든 소스 코드 및 자료는 https://github.com/Secondmoon-Kiom/CNUH-R-Lecture-2017 에서 확인할 수 있음. 
  \end{itemize}
\end{minipage}}
\end{quote}

\newpage

## R 설치하기(Windows 용)

R은 공개 소프트웨어로 http://www.r-project.org/ 에서 다운로드 및 설치 가능

1. 웹브라우저(i.e. explore, chrome, firefox 등)에서 http://www.r-project.org 이동
2. 좌측 R Logo 하단 Download 아래 `CRAN' 클릭

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 12cm]{Figures/Rorg-main-add.png}
  \caption[www.r-project.org 메인화면]{www.r-project.org 메인화면}\label{fig:R-install-01}
}
\end{figure}

3. 클릭 후 연결 창에서 스크롤 후 ``Korea'' 아래 링크 클릭 (그림 \ref{fig:R-install-02} 참조)

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 8cm]{Figures/CRAN-korea-01.PNG}
  \caption[CRAN 국가별 mirrors]{CRAN 국가별 mirrors}\label{fig:R-install-02}
}
\end{figure}

4. 클릭 후 세 가지 운영체제(Linux, Mac OS X, Windowns)에 따른 R 버전 선택 가능
    - 본 문서에서는 Windows 버전 설치만 다룸

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rinstall-01.png}
  \caption[운영체제 별 R 버전 선택]{운영체제 별 R 버전 선택}\label{fig:R-install-03}
}
\end{figure} 

5. ``Downloads R for Windows'' 링크 클릭하면 다음과 같은 화면으로 이동

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rinstall-02.png}
  \caption[Windows 용 R base 및 구성요소 다운로드]{Windows 용 R base 및 구성요소 다운로드}\label{fig:R-install-04}
}
\end{figure} 

6. R을 구성하는 하위구조 중 "base" 링크 클릭 후 다음 화면에서 "Downloads R 3.4.2 for Windows"를 클릭 후 설치 파일을 임의의 디렉토리에 저장 후 실행(그림 \ref{fig:R-install-05} 참조)

7. 참고로 3개 subdirectories에 대한 간략한 설명은 아래와 같음
    - `base`: R 실행 프로그램 
    - `contrib`: R package의 바이너리 파일 
    - `Rtools`: R package 개발 및 배포를 위한 프로그램

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rinstall-03.png}
  \caption[Windows 용 R 설치 파일 다운로드 페이지]{Windows 용 R 설치 파일 다운로드 페이지}\label{fig:R-install-05}
}
\end{figure} 

8. 다운로드한 파일을 실행하면 아래와 같은 대화창이 나타남
    - 한국어 선택 $\rightarrow$ 환영 화면에서 [다음(N)>] 클릭

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 14cm, height = 11cm]{Figures/R-install-F01.png}
  \caption[R 설치과정 01]{R 설치과정 01}\label{fig:R-install-06}
}
\end{figure} 

9. GNU 라이센스에 대한 설명 및 동의 여부([다음(N)>]) 클릭 (그림 \ref{fig:R-install-07})

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F02.png}
  \caption[R GNU general license]{R GNU general license}\label{fig:R-install-07}
}
\end{figure} 

10. 설치 디렉토리 설정 및 구성요소 설지 여부
    - 원하는 디렉토리 설정(예: `C:\R\R-3.4.2`) (그림 \ref{fig:R-install-08})
    - 기본 프로그램("Core Files"), 32 또는 64 bit 용 설치 파일, R console 한글 번역 모두 체크 뒤 [다음(N)>] 클릭 (그림 \ref{fig:R-install-09})
    
\begin{figure}[H]
{
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/R-install-F03.png}
  \caption[R 설치 디렉토리 설정]{R 설치 디렉토리 설정}\label{fig:R-install-08}
}
\end{figure}     

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F04.png}
  \caption[R 구성요소 설치]{R 구성요소 설치}\label{fig:R-install-09}
}
\end{figure}

11. R 스타트업 옵션 지정
    - 기본값("No" check-button)으로도 설치 진행 가능
    - 본 문서에서는 스타트업 옵션 변경으로 진행

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F05.png}
  \caption[R 스타트업 옵션 변경]{R 스타트업 옵션 변경}\label{fig:R-install-10}
}
\end{figure}


12. 화면표시방식(디스플레이 모드) 설정 변경
    - MDI: 한 윈도우 내에서 script 편집창, 출력, 도움말 창 사용
    - SDI: 다중 창에서 각각 script 편집창, 출력, 도움말 등을 독립적으로 열기
    
\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F06.png}
  \caption[R 화면표시방식 설정 변경]{R 화면표시방식 설정 변경}\label{fig:R-install-11}
}
\end{figure}

13. 도움말 형식에서 HTML 도움말 기반 선택

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F07.png}
  \caption[R 도움말 형식 변경]{R 도움말 형식 변경}\label{fig:R-install-12}
}
\end{figure}

14. 시작메뉴 폴더 선택(그림 \ref{fig:R-install-13})
    - "바로가기"를 생성할 시작 메뉴 폴더 지정 후 [다음(N)>] 클릭 후 설치 진행
    - 하단 "시작메뉴 폴더 만들지 않음" 체크박스 표시 시 시작메뉴에  "바로가기" 생성되지 않음(실행에 전혀 지장 없음)

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F08.png}
  \caption[시작메뉴 폴더 선택]{시작메뉴 폴더 선택}\label{fig:R-install-13}
}
\end{figure}

15. 추가 옵션 지정: 바탕화면 아이콘 생성 등 추가적 작업 옵션 체크 후 [다음(N)>] 클릭 $\rightarrow$ 설치 진행
    - 설치된 R 버전 정보 레지스트리 저장 여부 
    - `.Rdata` 확장자를 R 실행파일과 자동 연계

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/R-install-F09.png}
  \caption[R 추가옵션 사항 선택]{R 추가옵션 사항 선택}\label{fig:R-install-14}
}
\end{figure}

16. 설치 완료 후 바탕화면의 R 아이콘을 더블클릭하면 Rgui가 실행

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/Rgui.png}
  \caption[Windows에서 R 실행화면(SDI)]{Windows에서 R 실행화면(콘솔 창, SDI 모드)}\label{fig:R-install-15}
}
\end{figure}

## R 시작 및 작동 체크

위 R 시작화면에서 간단한 명령어들을 체크

- 그림 \ref{fig:R-install-15}에서 `>` 기호는 R의 명령 프롬프트임. 
- Checklist
    1) "Hello R" 출력
    2) 1부터 100까지 정수 출력
    3) 간단한 histogram 출력
    
```{r check-01, echo = TRUE, prompt = TRUE}
# 문자열 출력
print("Hello R")
```

여기서 `#` 기호는 주석의 시작을 의미하며 같은 행에서 `#` 뒤 내용의 코드는 실행되지 않음

```{r check-02, echo = T, prompt = T}
# 1부터 100까지 수열 출력
seq(1:100) # print("Hello R")
```

```{r check-03, echo = T, prompt = T, out.width="10 cm", out.height="10 cm"}
# 간단한 히스토그램
set.seed(12345) # random seed 지정
x <- rnorm(1000) # 평균 0, 분산 1인 정규분포에서 난수 1000개 생성
hist(x) # 히스토그램
```

\begin{quote}
\colorbox{gray!10}{\begin{minipage}{15cm}
\textbf{Tips}

R 명령어 실행 시 간혹 아니 매우 빈번히 오류가 나타나는데, 이를 해결할 수 있는 가장 손쉬운 방법은 Googling과 R의 도움말을 이용하는 것이 가장 효율적임. 
\end{minipage}}
\end{quote}

도움말을 볼 수 있은 R 함수 리스트

\begin{table}[H]
  \centering
  \begingroup\footnotesize
  \caption{R help 관련 명령어 리스트}
  \begin{tabular}{p{3cm}p{5cm}p{7cm}}
  \toprule
  \textbf{도움말 보기 명령어} & \textbf{설명} & \textbf{사용법} \\
  \midrule
  \texttt{help} 또는 \texttt{?}          & 도움말 시스템 호출               & \texttt{help(topic \textit{\# 도움말을 찾고자 하는 대상 또는 함수}) }\\
  \texttt{help.search} 또는 \texttt{??}  & 주어진 문자열을 포함한 문서 검색 & \texttt{help.search(pattern \textit{\# 찾고자 하는 문자열})} \\ 
  \texttt{example}                       & topic의 도움말 페이지에 있는 examples section 실행 & \texttt{example(topic \textit{\# 예제를 실행하고자 하는 topic 또는 함수})} \\
  \texttt{vignette}                      & topic의 pdf 또는 html 레퍼런스 메뉴얼 불러오기 & \texttt{vignette(topic \textit{\# topic에 저장된 reference manual})} \\
  \bottomrule
  \end{tabular}
  \endgroup
\end{table}

\begin{quote}
\colorbox{gray!10}{\begin{minipage}{15cm}
\textbf{Tips}
\begin{itemize}
\item \texttt{vignette}에서 제공하는 문서는 실제 분석을 기반으로 작성한 문서이기 때문에 초보자들이 R 패키지의 접근성을 높혀줌. \texttt{browseVignettes()}으로 현존하는 모든 R 패키지들의 vignette을 볼 수 있기 때문에 매우 유용함.
\item R 세션(R 콘솔이 시작해서 종료까지)에 설정된 옵션은 \texttt{options()} 실행으로 확인 가능
\item 현재 R 세션에 대한 정보는 \texttt{sessionInfo()} 함수로 확인 가능
\end{itemize}
\end{minipage}}
\end{quote}

_참고_

```{r option-ex, echo = T, prompt = T}
# 현재 설정된 출력 자리수 확인
options("digits")
pi
# 출력 자리수를 7에서 3으로 변경
options(digits = 3)
pi
```


### 이것으로 R 설치 완료??

- 기본적 R 사용방식은 입력한 명령어와 실행결과를 확인하는 대화형(interpreter) 방식
- R 기본 콘솔창 안에서도 \keystroke{TAB}을 누르면 자동완성 기능이라던가 \keystroke{$\uparrow$}, \keystroke{$\downarrow$}를 누르면 이전/이후 명령 기록을 볼 수 있음.
- 여러 줄 이상의 R 명령어라든가 반복적, 장기간 작업을 수행해야 하는 경우라면 R 명령어로 구성된 스크립트 작성 후 일괄 실행하는 것이 일반적임. 
- 이러한 다중 명령 코딩 시 콘솔창에 직접 입력하는 것은 비효율적 $\rightarrow$ 스크립트 에디터를 주로 사용
- R 자체적으로 기본적인 스크립트 에디터 제공(R editor) $\rightarrow$ 가독성 및 코딩 효율이 떨어짐
- 대표적 R 에디터: WinEdt (http://www.winedt.com), Tinn-R (https://sourceforge.net/projects/tinn-r/), Vim (http://www.vim.org/scripts/script.php?script_id=2628)
- 대부분의 분석 및 개발 환경이 RGUI 만으로 구성되어 있지 않음 $\rightarrow$ \textbf{RStudio}를 이용한 통합 분석 환경 설정 

\newpage

## RStudio 설치하기

- Rstudio: R 통합 분석/개발 환경(integrated development environment, IDE)으로 현재 가장 대중적으로 사용되고 있는 R 사용 환경
- 명령 콘솔 외 파일 편집, 데이터 보기, 명령 기록(`.history`), 그래프 등에 쉽게 접근 가능
- R과 마찬가지로 무료 소프트웨어임 

1. Rstudio 사이트 접속
    - 웹 브라우저를 통해 https://www.rstudio.com 연결 후 메인 화면에서 "Download Rstudio" 클릭
    - 혹은 상단 Pop-up manu 중 Products $\rightarrow$ RStudio 클릭 후 연결된 화면에서 다운로드 진행

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 13cm, height = 13cm]{Figures/Rstudio-main.png}
  \caption[RStudio 메인 페이지]{RStudio 메인 페이지 화면}\label{fig:Rstudio-install-01}
}
\end{figure}  

2. Desktop 또는 Sever 버전 중 택일
    - 서버용 설치를 위해서는 Server 클릭 $\rightarrow$ 소규모 자료 분석용으로는 불필요
    - 여기서는 "Desktop" 버전 선택 후 다음 링크로 이동

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rstudio-download.png}
  \caption[RStudio 다운로드 페이지]{RStudio 다운로드 페이지}\label{fig:Rstudio-install-02}
}
\end{figure}  

3. 운영체제에 맞는 Rstudio installer 다운로드(여기서는 Windows 버전 다운로드)

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rstudio-download-02.png}
  \caption[RStudio 운영체제 선택]{RStudio 운영체제 선택}\label{fig:Rstudio-install-03}
}
\end{figure}  

4. RStudio installer 다운로드 시 파일이 저장된 폴더에서 보통 `RStudio-xx.xx.xxx.exe` 형식의 파일명 확인
    - 더블 클릭 후 실행
    - \keystroke{다음>} 몇 번 누르면 설치 종료
    
\begin{figure}[H]
{
  \centering
  \includegraphics[width = 15cm, height = 12cm]{Figures/Rstudio-installer.png}
  \caption[RStudio 설치화면]{RStudio 설치화면}\label{fig:Rstudio-install-04}
}
\end{figure}  

5. 아래와 같은 실행화면이 나타나면 RStudio 설치 성공

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 15cm, height = 13cm]{Figures/Rstudio-init.png}
  \caption[RStudio 초기 실행화면]{RStudio 초기 실행화면}\label{fig:Rstudio-install-05}
}
\end{figure}  

## RStudio의 구성

### RStudio IDE 화면 구성

RStudio는 아래 그림 \ref{fig:Rstudio-part-01}과 같이 크게 4개 창으로 구성

\begin{figure}[H]
{
  \centering
  \includegraphics[width = 14cm, height = 12cm]{Figures/Rstudio-cap1.png}
  \caption[RStudio 화면구성]{RStudio 화면구성: 우하단 그림은 http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html 에서 발췌}\label{fig:Rstudio-part-01}
}
\end{figure}  


1. 콘솔(console)
    - R 명령어 실행 공간(RGui, 정확하게는 `Rterm.exe`가 실행되고 있는 창)
    - R 스크립트 또는 콘솔 창에서 작성한 명령어(프로그램) 실행 결과 출력
    - 경고, 에러/로그 등의 메세지 확인
    
2. 스크립트(script) R 명령어 입력 공간으로 일괄처리(batch processing) 가능
    - 일괄 처리를 위한 RStudio 제공 단축키
        - \keystroke{Ctrl} + \keystroke{Enter}: 선택한 블럭 내 명령어 실행
        - \keystroke{Alt} + \keystroke{Enter}: 선택 없이 커서가 위치한 라인의 명령어 실행 
    - 새 R 스크립트 파일 열기
        - R 상단 메뉴: \keystroke{File} $\rightarrow$ \keystroke{New File} $\rightarrow$ \keystroke{R Script}
        - 단축키: \keystroke{Ctrl} + \keystroke{Shift} + \keystroke{N}
    - R 스크립트 이외 `R Markdown`, `R Notebook`, `Shiny Web Application` 등 새 문서의 목적에 따라 다양한 종류의 문서 생성 가능

3. Environment/History
    1) Environment: 현재 R 작업환경에 저장되어 있는 객체의 특성을 요약 제시
        - 좌측 화살표 버튼 클릭: 해당 객체의 상세 정보 확인(그림 \ref{fig:Rstudio-envirn-01})
        - 우측 사각형 버튼 클릭: 객체가 데이터프레임인 경우 스프레드 시트 형태로 데이터셋 확인(그림 \ref{fig:Rstudio-envirn-02})
        - 디스켓 아이콘: 작업공간 저장 여부
        - 빗자루 아이콘: 작업공간 객체 일괄 삭제
        - Global Environment 아이콘: 현재 작업공간에서 사용중인 패키지 및 선택 패키지 내장 함수 목록 확인
\begin{figure}[H] {
  \centering
  \includegraphics[width = 12cm, height = 10cm]{Figures/Rstudio-envwin-01.png}
  \caption[RStudio Environment 창: 객체 상세정보]{RStudio Environment 창: 객체 상세정보}\label{fig:Rstudio-envirn-01}
} \end{figure}
\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/Rstudio-envwin-02.png}
  \caption[RStudio Environment 창: 스프레드 시트]{RStudio Environment 창: 스프레드 시트}\label{fig:Rstudio-envirn-02}
} \end{figure}
        - History: R 콘솔에서 실행된 명령어(스크립트)들의 이력 확인
\begin{figure}[H] {
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/Rstudio-historywin.png}
  \caption[RStudio History 창]{RStudio History 창}\label{fig:Rstudio-history}
} \end{figure}

4. File/Plots/Packages/Help/Viewer
    1) File: Windows 탐색기와 유사
        - 파일 및 폴더 생성, 삭제 수정, 그리고 작업경로 설정
\begin{figure}[H] {
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/Rstudio-file.png}
  \caption[RStudio File 창]{RStudio File 창}\label{fig:Rstudio-file}
} \end{figure}
    2) Plots: 콘솔 또는 스크립트 창으로부터 생성한 그래프 출력 
        - 작업 중 생성한 그래프가 이력에 따라 저장: \keystroke{$\Leftarrow$} 이전, \keystroke{$\Rightarrow$} 최근
        - \keystroke{Zoom} 기능으로 그래프 확대 가능
        - \keystroke{Export}를 통해 선택 그래프를 이미지 파일(`.png`, `.jpeg` 등), PDF 파일 및 PDF 출력 파일로 저장 가능
        - 엑스박스는 현재 화면에 출력된 그래프 삭제, 빗자루 아이콘은 생성한 모든 그래프 삭제
\begin{figure}[H] {
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/Rstudio-plotwin.png}
  \caption[RStudio Plots 창 화면]{RStudio Plots 창 화면}\label{fig:Rstudio-plot}
} \end{figure}
            
    3) Packages: 현재 컴퓨터에 설치된 R 패키지 목록 출력: 신규 설치 및 업데이트 가능
\begin{figure}[H] {
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/RStudio-packagewin.png}
  \caption[RStudio Packages 창 화면]{RStudio Packages 창 화면}\label{fig:Rstudio-pkgwin}
} \end{figure}
    4) Help: `help(topic)` 입력 시 도움말 창이 출력되는 공간
```{r r-help-win, echo = T, eval = F, prompt = T}
help(lm)
```
\begin{figure}[H] {
  \centering
  \includegraphics[width = 8cm, height = 8cm]{Figures/RStudio-helpwin.png}
  \caption[\texttt{help(lm)} 실행 후 RStudio Help 창 화면]{\texttt{help(lm)} 실행 후 RStudio Help 창 화면}\label{fig:Rstudio-hlpwin}
} \end{figure}

5. RStudio의 창 layout은 `[Tools]` $\rhd$ `[Global Options]` $\rhd$ `[Pane Layout]`에서 변경 가능

\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/RStudio-layout.png}
  \caption[RStudio Option 선택화면 및 Pane 레이아웃 선택 화면]{RStudio Option 선택화면 및 Pane 레이아웃 선택 화면}\label{fig:Rstudio-layout}
} \end{figure}


## RStudio에서 배치 파일 생성 및 실행




## R 패키지 설치하기

1. RStudio 

## `rJava` 설치하기

1. 자바 명령을 호출하는 패키지를 정상적으로 사용하기 위한 패키지
    - Java 계열 머신러닝 어플리케이션 활용 또는 최근까지 Excel 파일을 불러오기 위해 설치 필수(Excel에 관해서는 Hadley Wickham의 `readxl` 개발 이전에만...)
    - 다음은 Java가 설치되지 않은 환경에서 `rJava`를 불렀을 때 발생한 오류 예시임
\begin{figure}[H] {
  \centering
  \includegraphics[width = 10cm, height = 8cm]{Figures/R-rJava-error.png}
  \caption[\texttt{rJava} 에러 메세지]{\texttt{rJava} 에러 메세지}\label{fig:rJava-error}
} \end{figure}    
    
2. `rJava` 설치 전 자바 설치 및 Windows 시스템 환경 설정 필요

3. 자바 개발 키트(Java Development Kit, JDK)는 http://www.oracle.com/technetwork/java/javase/downloads/index.html 에서 다운로드 가능
    - `[Java Platform (JDK)]` $\rhd$ `[Download]` 클릭
\begin{figure}[H] {
  \centering
  \includegraphics[width = 10cm, height = 10cm]{Figures/R-rJava-install-01.png}
  \caption[JDK 다운로드 메인 페이지]{JDK 다운로드 페이지}\label{fig:rJava-01}
} \end{figure}

4. JDK 다운로드 전 현재 주로 작업하고 있는 R 버전 정보(32 bit vs. 64 bit) 확인
    - R 세션 시작 시 또는 RStudio에서 `[Tools]` $\rhd$ `[Global Options]`에서 R 버전 확인 가능
    - 라이센스 계약에 동의 후 확인한 R 버전에 대응하는 링크 클릭 후 다운로드 진행
\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/R-rJava-install-02.png}
  \caption[JDK 라이센스 및 다운로드 링크 페이지]{JDK 라이센스 및 다운로드 링크 페이지}\label{fig:rJava-02}
} \end{figure}    

5. 다운로드 완료 후 설치 확인
    - 정상적으로 설치한 경우라면 `C:\Program Files\Java\jdk-9.0.1` 디렉토리에서 설치 확인 가능
    - Java runtime environment (JRE)는 `C:\Program Files\Java\jre-9.0.1` 에서 설치 확인 가능

6. 새 사용자 변수 생성
    - \keystroke{Windows 시작} 클릭 $\rightarrow$ `[컴퓨터]` 우 클릭 $\rightarrow$ `[속성]` 클릭 후 다음 그림 \ref{fig:rJava-03}에서 `[고급 시스템 설정]` 클릭
\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/R-rJava-system.png}
  \caption[Windows 시스템 설정 화면]{Windows 시스템 설정 화면}\label{fig:rJava-03}
} \end{figure}    
    - 시스템 속성 창에서 `[환경변수(N)...]` 클릭 후 환경변수 창에서 사용자 변수 `[새로 만들기(N)...]` 클릭
    - 변수 이름에 `JAVA_HOME`, 변수 값에 JDK 설치 디렉토리 이름(예: `C:\Program Files\Java\jdk-9.0.1`) 입력
\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 10cm]{Figures/R-rJava-install-03.png}
  \caption[Windows 시스템 설정 화면]{Windows 시스템 설정 화면}\label{fig:rJava-04}
} \end{figure}    

7. 시스템 변수 `PATH` 갱신
    - JRE가 설치된 디렉토리(아래 나열)를 기존 `PATH`에 추가(디렉토리 구분자: `;`)
        - `C:\Program Files\Java\jre-9.0.1\bin`
        - `C:\Program Files\Java\jre-9.0.1\bin\server` 

8. 설정 완료 후 R 또는 RStudio 재실행 후 `rJava` 설치
```{r rJava-install, echo = T, eval = F, prompt = T, include = F}
install.packages(rJava)
library(rJava)
```

9. 별 다른 에러 메세지 출력이 없으면 성공적으로 설치

## RStudio 프로젝트 생성 및 `ProjectTemplate` 패키지 연동

<!-- 항상 이런 방식을 회피해야 되는 이유는 많다: -->

<!-- 어느 데이터 버젼이 원본이고, 어느 데이터 버젼이 변경된 것인지 분간하기 정말 힘들다; -->
<!-- 다양한 확장자를 갖는 파일과 뒤섞일 때, 정말 엉망이 된다; -->
<!-- 아마도 실제 파일을 찾고, 해당 그래프를 생성하는데 사용된 정확한 프로그램 코드와 맞는 그림을 연결시키는데 시간이 엄청 많이 소요될 것이다. -->
<!-- 프로젝트를 잘 배치하게 되면 궁극적으로 여러분의 삶을 편안하게 만들 것이다: -->

<!-- 데이터 정합성을 보장할 것이다; -->
<!-- 작성한 코드를 다른 사람(연구실 동료, 공동연구자, 지도교수)과 더 단순하게 공유할 수 있게 만든다; -->
<!-- 논문 제출할 때 코드를 쉽게 업로드할 수 있게 한다; -->
<!-- 휴가 뒤에, 프로젝트 백업을 더 손쉽게 한다. -->

<!-- RStudio의 가장 강력하고 유용한 측면 중 하나가 프로젝트 관리 기능이다. 프로젝트 관리 기능을 사용해서, 모든 것이 갖춘 재현가능한 프로젝트를 생성한다. -->
<!-- RStudio에서 새로운 프로젝트를 생성한다: -->

<!-- “File” 메뉴를 클릭하고 나서, “New Project” 선택한다. -->
<!-- “New Directory”를 클릭한다. -->
<!-- “Empty Project”를 클릭한다. -->
<!-- 프로젝트를 저장할 디렉토리 명칭을 타이핑한다. 예를 들어, “my_project”. -->
<!-- “Create a git repository”에 대한 체크박스가 선택되었는지 확실히 한다. -->
<!-- “Create Project” 버튼을 클릭한다. -->

<!-- (엑셀처럼) 인터랙티브하게 데이터를 작업하게 되면, 필연적으로 데이터에 변형이 일어나고 데이터 출처와, 수집이 이루어진 뒤에 어떻게 변형되었는지 확인을 할 수 없게 된다. 따라서, 데이터를 “읽기-전용(Read-Only)”으로 다룬다. -->

<!-- 많은 경우에, 데이터가 “지저분하다”: 상당한 전처리 과정을 거쳐야 R 형식(혹은 다른 프로그래밍 언어)으로 유용하게 사용될 수 있다. 이런 작업이 “데이터 정제작업”이라고 불린다. 1 별도 디렉토리에 데이터 정제 스크립트를 보관하고, “정제된” 데이터셋을 보관하는 두번째 “읽기-전용” 데이터 디렉토리를 생성하는 것도 유용하다. -->

<!-- 프로젝트 관리를 자동화하는 한 방식은 제3자 팩키지, ProjectTemplate을 설치하는 것이다. 해당 팩키지는 프로젝트 관리에 대한 이상적인 디렉토리 구조를 설정해 놓는다. 팩키지가 자동으로 분석 파이브라인/작업흐름을 구성해서 구조화해 놓는다. RStudio 기본설정된 프로젝트 관리 기능과 Git을 섞어 사용하면, 작업을 기록할 뿐만 아니라, 동료 연구원과 작업산출물 공유를 가능케 한다. -->

<!-- ProjectTemplate을 설치한다. -->
<!-- 라이브러리를 불러 적재한다. -->
<!-- 프로젝트를 초기화한다. -->

## R + RStudio를 잘 활용 하려면?

1. 주기적인 update
2. RStudio 제
<!-- - \keystroke{Ctrl} + \keystroke{Alt} + \keystroke{R} 또는 \keystroke{Ctrl} + \keystroke{Shift} + \keystroke{Enter}: 실행하고자 하는 R 명령어들이 저장된 배치파일(`filename.R`) 일괄실행(콘솔에 실행 명령어 출력) -->
<!-- - \keystroke{Ctrl} + \keystroke{Shift} + \keystroke{S}: 위 작업을 실행 명령어 출력 없이 실행 -->
        
<!-- \begin{figure}[H] -->
<!-- { -->
<!--   \centering -->
<!--   \includegraphics[width = 12cm, height = 10cm]{Figures/Rstudio-layout.png} -->
<!--   \caption[RStudio Global Options: Pane layout]{RStudio Global Options에서 화면 레이아웃 조정}\label{fig:Rstudio-layout} -->
<!-- } -->
<!-- \end{figure}   -->

# R의 기본 사용

- R은 객체지향언어(object-oriented language)임
- 객체: 숫자, 데이터셋, 단어, 테이블, 분석결과 등 모든 것을 칭함
    - "객체지향"의 의미는 R의 모든 명령어는 객체를 대상으로 이루어진다는 것을 의
- R에서 사용자가 데이터 입력을 위해 생성 또는 읽어온 객체(object)는 종종 변수(variable)라는 말과 혼용됨. 
- 본 문서에서는 최상위 데이터 저장장소를 객체라고 명명하며 데이터프레임과 같이 여러 종류의 데이터타입으로 이루어진 객체의 1차원 속성을 변수라고 칭함. 
- R을 다룰 수 있으려면 기본적인 R의 데이터 할당 방식과 데이터 타입, 그리고 연산 방법에 대한 이해가 있어야 함. 
- 특히 데이터 타입에 따라 사용하는 함수 또는 분석 방법이 조금씩 다른 것이 R의 특징임
- 따라서 R의 데이터 타입에 좀 더 익숙해져야 R을 보다 쉽게 다룰 수 있음

\begin{quote}
\colorbox{gray!10}{\begin{minipage}{15cm}
\textbf{Tips: 들어가기 앞서  알아두면 유용한 단축키 및 명령어}
  \begin{itemize}
    \item R console에 저장된 모든 객체들을 일괄 삭제: \texttt{rm(list = ls())}
    \item R console 화면 청소: \keystroke{Ctrl} + \keystroke{L} 
  \end{itemize}
\end{minipage}}
\end{quote}

## R 객체 입력 방법 및 변수 설정 규칙

- R의 데이터 타입은 1)스칼라, 2)벡터, 3)요인, 4)행렬, 5)배열, 6)데이터프레임, 7)리스트 로 나눌 수 있음.
- 자세히 들어가기 전 R 데이터 타입의 구조 다이어그램을 먼저 살펴봄

\begin{figure}[H] {
  \centering
  \includegraphics[width = 15cm, height = 13cm]{Figures/datatype-diagram}
  \caption[R 데이터 타입 구조 다이어그램]{R 데이터 타입 구조 다이어그램}\label{fig:R-datatype}
} \end{figure}

\vspace{1cm}

### 객체 입력 및 할당

- R의 가장 기본적인 

앞서 열거한 7 가지 데이터 타입을 설명하기 전, 

1. 객체를 할당하는 두 가지 방법
    1) `=`
    2) `<-` 또는 `->`
    3) 두 할당지시자의 차이점: 

## 스칼라 

## 벡터

## 리스트

## 행렬

## 배열

## 데이터 프레임

## 데이터 연산


# 데이터 조작

## 실습 데이터 설명



## 파일 입출력

### 외부 파일 읽어오기/내보내기

`read.table()`, `write.table()`
`readxl::read_excel()`


RStudio 메뉴 명령을 통한 파일 입출력

## 벡터화 연산(apply 계열 함)

## `dplyr + tidyr`을 이용한 data wrangling 


# `ggplot2`를 이용한 자료 시각화

## `ggplot()` vs. `plot()`

## Grammar of Graphics


# 재현가능한 데이터 연동 문서 작성 

# References 
